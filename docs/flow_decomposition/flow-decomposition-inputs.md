# Flow decomposition inputs

## Network

The first input of the flow decomposition algorithm is a network. As this simulation uses [power flow](inv:powsyblcore:std:doc#simulation/loadflow/index)
simulations for losses compensation, this network should converge.

Any available source can be used as a valid input for flow decomposition (including UCTE, CGMES, XIIDM).

>Some limitations exist in the type of network devices handled in the algorithm :
>- Flows on three windings transformers or HVDCs cannot be decomposed
>- Three windings transformers and HVDC lines losses are not compensated in losses compensation step
>- Flows generated by HVDC which are not modeled with unmerged xnodes are not separated from loop flows

## GLSK

The second input of the flow decomposition algorithm are the GLSK to be used for each zone.

GLSK used must be linear (i.e. proportional, not merit order), and two implementations exist:
- Default implementation which is Country GSK, i.e. automatic GLSK on all generators of the country, proportional to
their power setpoint.
- GLSK document based, that relies on an input handled by PowSyBl GLSK importers.
If the input file does not contain a given country of the network, default
implementation will be used for this country.

## Network elements

The third input of the flow decomposition algorithm are the network elements of interest which flow is to be decomposed
into the parts listed in introduction - called XNEC (cross-border relevant network element with contingency) in the flow
decomposition methodology.

Algorithm may handle different network elements in the decomposition for each network state (base case or per contingency).

Current implementation of the algorithm is based on a XnecProvider interface. This interface should provide XNECs in the
base case. Basic implementations of this interface are available:
- Set of all branches.
- Set of branches selected by IDs.
- Set of all interconnections on the network (i.e. branches which have different country attribute in their source and destination substation).
- Set of all interconnections on the network with the addition of all branches that have a maximum zonal PTDF greater than 5%.

Post contingency network elements can only be given to the algorithm using selection by IDs.
A Contingency can be defined by its ID and the IDs of the affected equipment, which creates a 
PowSyBl branch contingency by default. Alternatively, it can be specified directly using the
PowSyBl [Contingency](https://powsybl.readthedocs.io/projects/powsybl-core/en/stable/simulation/security/index.html#contingencies) object. 